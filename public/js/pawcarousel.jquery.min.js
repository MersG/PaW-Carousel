/*
 * PaW Carousel - Version: 2.0
 * http://picturesandwriting.com
 * Copyright (c) 2014 Shaun Morrison; Licensed: GPL
 * Requires: jQuery v1.7 or later
 * Author: Shaun Morrison
 */
!function($){$.fn.pawCarousel=function(t){var i={carouselItemCls:"paw-carousel-item",carouselItemMediaCls:"paw-carousel-item-media",carouselItemsWrapCls:"paw-carousel-items-wrap",carouselNavItemCls:"paw-carousel-nav-item",nextLinkCls:"paw-carousel-next",prevLinkCls:"paw-carousel-prev",activeCls:"active",croppedCls:"cropped",carouselItemSpace:"css",animSpeed:800,alignment:"center",setsEachSide:1,carouselHtType:"shortest"},e=$.extend({},i,t);return this.each(function(){function t(){fi=window.innerHeight,void 0==fi&&(fi=$(window).height()),li=$(window).width()}function i(){_=j.find("."+Q)}function n(){_.find("iframe").addClass(q)}function a(t){_.find("iframe").each(function(){var i=$(this),e=i.attr(Z),n=vi*e;i.attr("height",vi),i.attr("width",n),t&&s(i,n)})}function r(t){var i=t.find("iframe");if(i.length){var e=i.attr("src");i.attr("src",""),i.attr("src",e)}}function s(t,i){var e='<div style="width:'+i+"px; height:"+Si+'px" class="'+U+'"></div>';t.before(e).addClass(V)}function o(){_.addClass(O),ti=j.find("."+O),"css"!=e.carouselItemSpace&&ti.css({"margin-right":Hi})}function c(t){ai=t,ai.siblings().removeClass(J),ai.addClass(J),Ii=parseInt(ai.attr(Ai))}function d(){c(j.find("."+Q).first()),f(0),v(0)}function l(t,i){f(t,i),v()}function f(t,i){var e=ai,n=Ii,a=0,s=0;"forwards"==i&&n==gi?(c(ti.first()),u("last"),h(),s=-hi*bi,xi=-hi*bi+ki):"backwards"==i&&0==n?(c(ti.last()),u("first"),m(),s=-hi-hi*bi+Di[gi].itemWid,xi=-hi-hi*bi+Di[gi].itemWid+ki):(t>0&&(a=Di[t-1].itemPosFromStart),c(j.find("."+R+"."+Y+t)),u(),s=-(a+hi*bi),xi=s+ki),r(e)}function u(t){if("center"==e.alignment){var i=ui/2;ki=i-Di[Ii].itemWid/2,"first"==t?Wi=i-Di[0].itemWid/2:"last"==t&&(yi=i-Di[gi].itemWid/2)}else"right"==e.alignment&&(ki=ui-Di[Ii].itemWid,"first"==t?Wi=ui-Di[0].itemWid:"last"==t&&(yi=ui-Di[gi].itemWid))}function h(){var t=-hi+Di[gi].itemWid+yi;ni.css({left:t})}function m(){var t=-hi-hi*bi+Wi;ni.css({left:t})}function v(t){t="undefined"!=typeof t?t:Ti,ci=!0,0==t?ni.css({left:xi}):ni.stop(!0).animate({left:xi},Ti)}function p(){ti.each(function(){var t=$(this),i=t.find("."+q);g(t,gi+=1),w(t,i),C(t),("shortest"==Mi||"tallest"==Mi)&&y(t)})}function w(t,i){if(void 0!=i.attr("width")&&void 0!=i.attr("height"))var e=i.attr("width")/i.attr("height");else var e=t.width()/t.height();e=e.toFixed(3),i.attr(Z,e)}function g(t,i){t.attr(Ai,i),t.addClass(Y+i)}function C(t){var i=t.find("img."+q),e=i.attr("data-src-2x");if(oi&&void 0!=e)var n=e;else var n=i.attr("data-src");i.removeAttr("data-src"),i.removeAttr("data-src-2x"),i.attr("src",n)}function x(){Li=ni.html(),Li=Li.replace(/ paw-carousel-item-orig/g,"")}function I(){Di=[],hi=0,ti.each(function(t){var i=$(this);i.width("auto"),mi=i.width(),k(t,i,mi),W(mi)})}function k(t,i,e){var n=j.find("."+Y+t);e>=ui?(mi=ui,n.width(mi).addClass(K),di=!0):(mi+=Hi,di&&n.removeAttr("style").removeClass(K))}function W(t){hi+=t,Di.push({itemWid:t,itemPosFromStart:hi})}function y(t){var i=t.height(),e=t.find("iframe").length;"shortest"!=Mi||e?"tallest"==Mi&&(Si=i>Si?i:Si):Si=Si>i?i:Si}function b(){"shortest"==Mi||"tallest"==Mi?(ni.height(Si),j.height(Si)):(ni.height(Mi),j.height(Mi))}function S(t){"before"==t?ni.prepend(Li):ni.append(Li),wi++,L()}function H(){"css"==Hi&&(Hi=parseInt(_.first().css("margin-right"),10))}function T(){if(window.matchMedia){var t=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");oi=t&&t.matches||window.devicePixelRatio>1?!0:!1}}function L(){pi=hi*wi,ni.width(pi)}function M(){ui=j.width(),vi=Si}function A(){G.length&&(D(),ii.on("click",function(t){t.preventDefault(),$link=$(this);var i=$link.attr(Ai);Ii!=i&&(F($link),l(i))}))}function D(){ii.each(function(t){$(this).attr(Ai,t),0==t&&F($(this))})}function F(t){t.siblings().removeClass(J),t.addClass(J),ei=t}function P(){ri.on("click",function(t){t.preventDefault(),z()}),si.on("click",function(t){t.preventDefault(),E()})}function z(){var t=Ii+1;F(ei.next()),t>gi&&(t=0,F(ii.first())),l(t,"forwards")}function E(){var t=Ii-1;F(ei.prev()),0>t&&(t=gi,F(ii.last())),l(t,"backwards")}function N(){setTimeout(function(){ai.addClass(X)},500),setTimeout(function(){_.addClass(X)},1500)}var j=$(this),Q=e.carouselItemCls,R=e.carouselItemCls+"-orig",q=e.carouselItemMediaCls,B=e.carouselItemsWrapCls,G=e.carouselNavItemCls,J=e.activeCls,K=e.croppedCls,O="paw-carousel-item-orig",U="paw-carousel-item-vid-foundation",V="paw-carousel-item-vid",X="paw-carousel-item-visible",Y=Q+"-",Z="data-paw-orig-ratio",_=j.find("."+Q),ti,ii=j.next().find("."+G),ei,ni=j.children("."+B),ai,ri=j.find("."+e.nextLinkCls),si=j.find("."+e.prevLinkCls),oi=!1,ci=!1,di=!1,li,fi,ui=0,hi=0,mi=0,vi=0,pi=0,wi=1,gi=-1,Ci=0,xi=0,Ii=0,ki=0,Wi=0,yi=0,bi=e.setsEachSide,Si=_.first().height(),Hi=e.carouselItemSpace,Ti=e.animSpeed,Li,Mi=e.carouselHtType,Ai="data-paw-item-num",Di=[];t(),T(),H(),n(),o(),p(),M(),a(!0),I(),x();for(var Fi=0;bi>Fi;Fi++)S("before"),S("after");i(),b(),d(),A(),P(),N();var Pi=function(){$(window).one("resize",function(){var i=window.innerHeight?window.innerHeight:$(window).height(),e=$(window).width();(e!=li||i!=fi)&&(t(),M(),I(),L(),f(Ii),v(0)),setTimeout(Pi,100)})};Pi()}),this}}(jQuery);