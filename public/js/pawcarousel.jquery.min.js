/*
 * PaW Carousel - Version: 2.0
 * http://picturesandwriting.com
 * Copyright (c) 2014 Shaun Morrison; Licensed: GPL
 * Requires: jQuery v1.7 or later
 * Author: Shaun Morrison
 */
!function($){$.fn.pawCarousel=function(t){var i={carouselItemCls:"paw-carousel-item",carouselItemMediaCls:"paw-carousel-item-media",carouselItemsWrapCls:"paw-carousel-items-wrap",carouselNavItemCls:"paw-carousel-nav-item",nextLinkCls:"paw-carousel-next",prevLinkCls:"paw-carousel-prev",activeCls:"active",croppedCls:"cropped",scaledCls:"scaled",carouselItemSpace:"css",animSpeed:800,alignment:"center",setsEachSide:1,carouselHtType:"shortest",carouselResizeType:"cropped"},e=$.extend({},i,t);return this.each(function(){function t(){xi=window.innerHeight,void 0==xi&&(xi=$(window).height()),Ci=$(window).width()}function i(){G.find("."+V).length&&(gi=!0)}function n(){ri=G.find("."+J)}function a(){ri.find("iframe").addClass(O)}function s(){ri.find("iframe").each(function(){var t=$(this);o(t,!0)})}function r(){oi.each(function(t){var i=$(this),e=i.find("iframe");if(e.length){var n=G.find("."+ai+t);e=n.find("iframe"),o(e)}})}function o(t,i){var e=t.attr(si),n=Ri*e;t.attr("height",Ri),t.attr("width",n),i&&d(t,n)}function c(t,i){if(i!=zi){var e=t.find("iframe");if(e.length){var n=e.attr("src");e.attr("src",""),e.attr("src",n)}}}function d(t,i){var e='<div style="width:'+i+"px; height:"+Ri+'px" class="'+ti+'"></div>';t.before(e).addClass(ii)}function l(){"scaled"==Qi&&oi.find("img."+O).removeAttr("height width")}function f(){Ri="shortest"==ji?9999:"longest"==ji?0:ji}function u(){ri.addClass(_),oi=G.find("."+_),"css"!=e.carouselItemSpace&&oi.css({"margin-right":$i})}function h(t){fi=t,fi.siblings().removeClass(X),fi.addClass(X),zi=parseInt(fi.attr(qi))}function m(){h(G.find("."+J).first()),p(0),x(0)}function v(t,i){p(t,i),x()}function p(t,i){var e=fi,n=zi,a=0,s=0;"forwards"==i&&n==Ti?(h(oi.first()),w("last"),g(),s=-ki*Pi,Hi=-ki*Pi+Li):"backwards"==i&&0==n?(h(oi.last()),w("first"),C(),s=-ki-ki*Pi+Bi[Ti].itemWid,Hi=-ki-ki*Pi+Bi[Ti].itemWid+Li):(t>0&&(a=Bi[t-1].itemPosFromStart),h(G.find("."+K+"."+ai+t)),w(),s=-(a+ki*Pi),Hi=s+Li),c(e,n)}function w(t){if("center"==e.alignment){var i=Ii/2;Li=i-Bi[zi].itemWid/2,"first"==t?Mi=i-Bi[0].itemWid/2:"last"==t&&(Di=i-Bi[Ti].itemWid/2)}else"right"==e.alignment&&(Li=Ii-Bi[zi].itemWid,"first"==t?Mi=Ii-Bi[0].itemWid:"last"==t&&(Di=Ii-Bi[Ti].itemWid))}function g(){var t=-ki+Bi[Ti].itemWid+Di;li.css({left:t})}function C(){var t=-ki-ki*Pi+Mi;li.css({left:t})}function x(t){t="undefined"!=typeof t?t:Ei,vi=!0,0==t?li.css({left:Hi}):li.stop(!0).animate({left:Hi},Ei)}function I(){oi.each(function(){var t=$(this),i=t.find("."+O);y(t,Ti+=1),k(t,i),W(t),("shortest"==ji||"tallest"==ji)&&H(t)})}function k(t,i){if(void 0!=i.attr("width")&&void 0!=i.attr("height"))var e=i.attr("width")/i.attr("height");else var e=t.width()/t.height();e=e.toFixed(3),i.attr(si,e)}function y(t,i){t.attr(qi,i),t.addClass(ai+i)}function W(t){var i=t.find("img."+O),e=i.attr("data-src-2x");if(mi&&void 0!=e)var n=e;else var n=i.attr("data-src");i.removeAttr("data-src"),i.removeAttr("data-src-2x"),i.attr("src",n)}function b(){Ni=li.html(),Ni=Ni.replace(/ paw-carousel-item-orig/g,"")}function S(){Bi=[],ki=0,("shortest"==ji&&wi||"tallest"==ji&&wi)&&f(),oi.each(function(t){var i=$(this);i.width("auto").removeClass(Y),yi=i.width(),T(t,i,yi),A(yi),("shortest"==ji&&wi||"tallest"==ji&&wi)&&(H(i),i.find("img."+O).removeAttr("height width"))})}function T(t,i,e){var n=G.find("."+ai+t);if(e+=$i,"cropped"==Qi&&e>=Ii)yi=Ii,n.width(yi).addClass(Y),pi=!0;else if(e>=Ii){yi=Ii,n.width(yi).addClass(Z),wi=!0;var a=i.find("iframe")}else yi+=$i,(pi||wi)&&n.removeAttr("style").removeClass(Y)}function A(t){ki+=t,Bi.push({itemWid:t,itemPosFromStart:ki})}function H(t){var i=t.height(),e=t.find("iframe").length;"shortest"!=ji||e?"tallest"==ji&&(Ri=i>Ri?i:Ri):Ri=Ri>i?i:Ri}function z(){"shortest"==ji||"tallest"==ji?(li.height(Ri),G.height(Ri)):(li.height(ji),G.height(ji))}function L(t){"before"==t?li.prepend(Ni):li.append(Ni),Si++,F()}function M(){"css"==$i&&($i=parseInt(ri.first().css("margin-right"),10))}function D(){if(window.matchMedia){var t=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");mi=t&&t.matches||window.devicePixelRatio>1?!0:!1}}function F(){bi=ki*Si,li.width(bi)}function P(){Ii=G.width(),Wi=Ri}function R(){V.length&&(E(),ci.on("click",function(t){t.preventDefault(),$link=$(this);var i=$link.attr(qi);zi!=i&&(gi&&N($link),v(i))}))}function E(){ci.each(function(t){$(this).attr(qi,t),0==t&&gi&&N($(this))})}function N(t){t.siblings().removeClass(X),t.addClass(X),di=t}function j(){ui.on("click",function(t){t.preventDefault(),Q()}),hi.on("click",function(t){t.preventDefault(),q()})}function Q(){var t=zi+1;gi&&N(di.next()),t>Ti&&(t=0,gi&&N(ci.first())),v(t,"forwards")}function q(){var t=zi-1;gi&&N(di.prev()),0>t&&(t=Ti,gi&&N(ci.last())),v(t,"backwards")}function B(){var t=ri.find("img."+O),i=t.length;t.load(function(){Fi++,Fi==i&&setTimeout(function(){fi.addClass(ei),setTimeout(function(){ri.addClass(ei)},800)},500)})}var G=$(this),J=e.carouselItemCls,K=e.carouselItemCls+"-orig",O=e.carouselItemMediaCls,U=e.carouselItemsWrapCls,V=e.carouselNavItemCls,X=e.activeCls,Y=e.croppedCls,Z=e.scaledCls,_="paw-carousel-item-orig",ti="paw-carousel-item-vid-foundation",ii="paw-carousel-item-vid",ei="paw-carousel-item-visible",ni="paw-carousel-crop-comp",ai=J+"-",si="data-paw-orig-ratio",ri=G.find("."+J),oi,ci=G.next().find("."+V),di,li=G.children("."+U),fi,ui=G.find("."+e.nextLinkCls),hi=G.find("."+e.prevLinkCls),mi=!1,vi=!1,pi=!1,wi=!1,gi=!1,Ci,xi,Ii=0,ki=0,yi=0,Wi=0,bi=0,Si=1,Ti=-1,Ai=0,Hi=0,zi=0,Li=0,Mi=0,Di=0,Fi=0,Pi=e.setsEachSide,Ri=0,$i=e.carouselItemSpace,Ei=e.animSpeed,Ni,ji=e.carouselHtType,Qi=e.carouselResizeType,qi="data-paw-item-num",Bi=[];t(),D(),M(),i(),f(),a(),u(),I(),P(),s(),S(),r(),l(),b();for(var Gi=0;Pi>Gi;Gi++)L("before"),L("after");n(),z(),m(),R(),j(),B();var Ji=function(){$(window).one("resize",function(){var i=window.innerHeight?window.innerHeight:$(window).height(),e=$(window).width();(e!=Ci||i!=xi)&&(t(),P(),S(),r(),z(),F(),p(zi),x(0)),setTimeout(Ji,100)})};Ji()}),this}}(jQuery);