/*
 * PaW Carousel - Version: 2.0
 * http://picturesandwriting.com
 * Copyright (c) 2014 Shaun Morrison; Licensed: GPL
 * Requires: jQuery v1.7 or later
 * Author: Shaun Morrison
 */
!function($){$.fn.pawCarousel=function(t){var i={carouselItemCls:"paw-carousel-item",carouselItemMediaCls:"paw-carousel-item-media",carouselItemsWrapCls:"paw-carousel-items-wrap",carouselNavItemCls:"paw-carousel-nav-item",nextLinkCls:"paw-carousel-next",prevLinkCls:"paw-carousel-prev",activeCls:"active",croppedCls:"cropped",carouselItemSpace:"css",animSpeed:800,alignment:"center",setsEachSide:1,carouselHtType:"shortest"},e=$.extend({},i,t);return this.each(function(){function t(){ui=window.innerHeight,void 0==ui&&(ui=$(window).height()),fi=$(window).width()}function i(){ti=j.find("."+Q)}function n(){ti.find("iframe").addClass(q)}function a(t){ti.find("iframe").each(function(){var i=$(this),e=i.attr(_),n=pi*e;i.attr("height",pi),i.attr("width",n),t&&s(i,n)})}function r(t){var i=t.find("iframe");if(i.length){var e=i.attr("src");i.attr("src",""),i.attr("src",e)}}function s(t,i){var e='<div style="width:'+i+"px; height:"+Hi+'px" class="'+U+'"></div>';t.before(e).addClass(V)}function o(){ti.addClass(O),ii=j.find("."+O),"css"!=e.carouselItemSpace&&ii.css({"margin-right":Ti})}function c(t){ri=t,ri.siblings().removeClass(J),ri.addClass(J),ki=parseInt(ri.attr(Ai))}function d(){c(j.find("."+Q).first()),f(0),v(0)}function l(t,i){f(t,i),v()}function f(t,i){var e=ri,n=ki,a=0,s=0;"forwards"==i&&n==Ci?(c(ii.first()),u("last"),h(),s=-mi*Si,Ii=-mi*Si+Wi):"backwards"==i&&0==n?(c(ii.last()),u("first"),m(),s=-mi-mi*Si+Di[Ci].itemWid,Ii=-mi-mi*Si+Di[Ci].itemWid+Wi):(t>0&&(a=Di[t-1].itemPosFromStart),c(j.find("."+R+"."+Y+t)),u(),s=-(a+mi*Si),Ii=s+Wi),r(e)}function u(t){if("center"==e.alignment){var i=hi/2;Wi=i-Di[ki].itemWid/2,"first"==t?yi=i-Di[0].itemWid/2:"last"==t&&(bi=i-Di[Ci].itemWid/2)}else"right"==e.alignment&&(Wi=hi-Di[ki].itemWid,"first"==t?yi=hi-Di[0].itemWid:"last"==t&&(bi=hi-Di[Ci].itemWid))}function h(){var t=-mi+Di[Ci].itemWid+bi;ai.css({left:t})}function m(){var t=-mi-mi*Si+yi;ai.css({left:t})}function v(t){t="undefined"!=typeof t?t:Fi,di=!0,0==t?ai.css({left:Ii}):ai.stop(!0).animate({left:Ii},Fi)}function p(){ii.each(function(){var t=$(this),i=t.find("."+q);g(t,Ci+=1),w(t,i),C(t),("shortest"==Mi||"tallest"==Mi)&&y(t)})}function w(t,i){if(void 0!=i.attr("width")&&void 0!=i.attr("height"))var e=i.attr("width")/i.attr("height");else var e=t.width()/t.height();e=e.toFixed(3),i.attr(_,e)}function g(t,i){t.attr(Ai,i),t.addClass(Y+i)}function C(t){var i=t.find("img."+q);if(ci&&i.attr("data-src-2x"))var e=i.attr("data-src-2x");else var e=i.attr("data-src");i.removeAttr("data-src"),i.removeAttr("data-src-2x"),i.attr("src",e)}function x(){Li=ai.html(),Li=Li.replace(/ paw-carousel-item-orig/g,"")}function I(){Di=[],mi=0,ii.each(function(t){var i=$(this);i.width("auto"),vi=i.width(),k(t,i,vi),W(vi)})}function k(t,i,e){var n=j.find("."+Y+t);e>=hi?(vi=hi,n.width(vi).addClass(K),li=!0):(vi+=Ti,li&&n.removeAttr("style").removeClass(K))}function W(t){mi+=t,Di.push({itemWid:t,itemPosFromStart:mi})}function y(t){var i=t.height(),e=t.find("iframe").length;"shortest"!=Mi||e?"tallest"==Mi&&(Hi=i>Hi?i:Hi):Hi=Hi>i?i:Hi}function b(){"shortest"==Mi||"tallest"==Mi?(ai.height(Hi),j.height(Hi)):(ai.height(Mi),j.height(Mi))}function S(t){"before"==t?ai.prepend(Li):ai.append(Li),gi++,L()}function H(){"css"==Ti&&(Ti=parseInt(ti.first().css("margin-right"),10))}function T(){if(window.matchMedia){var t=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");ci=t&&t.matches||window.devicePixelRatio>1?!0:!1}}function L(){wi=mi*gi,ai.width(wi)}function M(){hi=j.width(),pi=Hi}function A(){G.length&&(D(),ei.on("click",function(t){t.preventDefault(),$link=$(this);var i=$link.attr(Ai);ki!=i&&(F($link),l(i))}))}function D(){ei.each(function(t){$(this).attr(Ai,t),0==t&&F($(this))})}function F(t){t.siblings().removeClass(J),t.addClass(J),ni=t}function P(){si.on("click",function(t){t.preventDefault(),z()}),oi.on("click",function(t){t.preventDefault(),E()})}function z(){var t=ki+1;F(ni.next()),t>Ci&&(t=0,F(ei.first())),l(t,"forwards")}function E(){var t=ki-1;F(ni.prev()),0>t&&(t=Ci,F(ei.last())),l(t,"backwards")}function N(){setTimeout(function(){ri.addClass(X)},500),setTimeout(function(){ti.addClass(X)},1500)}var j=$(this),Q=e.carouselItemCls,R=e.carouselItemCls+"-orig",q=e.carouselItemMediaCls,B=e.carouselItemsWrapCls,G=e.carouselNavItemCls,J=e.activeCls,K=e.croppedCls,O="paw-carousel-item-orig",U="paw-carousel-item-vid-foundation",V="paw-carousel-item-vid",X="paw-carousel-item-visible",Y=Q+"-",Z=e.loadingCls,_="data-paw-orig-ratio",ti=j.find("."+Q),ii,ei=j.next().find("."+G),ni,ai=j.children("."+B),ri,si=j.find("."+e.nextLinkCls),oi=j.find("."+e.prevLinkCls),ci=!1,di=!1,li=!1,fi,ui,hi=0,mi=0,vi=0,pi=0,wi=0,gi=1,Ci=-1,xi=0,Ii=0,ki=0,Wi=0,yi=0,bi=0,Si=e.setsEachSide,Hi=ti.first().height(),Ti=e.carouselItemSpace,Li,Mi=e.carouselHtType,Ai="data-paw-item-num",Di=[],Fi=e.animSpeed;t(),T(),H(),n(),o(),p(),M(),a(!0),I(),x();for(var Pi=0;Si>Pi;Pi++)S("before"),S("after");i(),b(),d(),A(),P(),N();var $i=function(){$(window).one("resize",function(){var i=window.innerHeight?window.innerHeight:$(window).height(),e=$(window).width();(e!=fi||i!=ui)&&(t(),M(),I(),L(),f(ki),v(0)),setTimeout($i,100)})};$i()}),this}}(jQuery);