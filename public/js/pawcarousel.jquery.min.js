/* PaW Carousel - Version: 1.0 * http://picturesandwriting.com * Copyright (c) 2013 Shaun Morrison; Licensed: GPL * Requires: jQuery v1.7 or later * Author: Shaun Morrison */
(function(e){e.fn.pawCarousel=function(t){var n={carouselItemCls:"paw-carousel-item",carouselNavItemCls:"paw-carousel-nav-item",activeCls:"active",carouselMediaCls:"paw-carousel-media",nextLinkCls:"paw-carousel-next",prevLinkCls:"paw-carousel-prev",loadingCls:"paw-loading",animSpeed:800,itemsClonedFromEdge:3,alignment:"center",imageCrop:true},r=e.extend({},n,t);this.each(function(){function A(){h=t.find("."+n+"."+s);$carouselNavItemActive=t.next().find("."+i+"."+s)}function O(){if(t.find("."+n+"."+s).hasClass(a)){var e=L.clone();t.find("."+n).removeClass(a);e.removeClass(s+" "+o+" "+u);e.appendTo(d).promise().done(function(){_()});t.find("."+n).slice(-3).addClass(a)}}function M(){if(t.find("."+n+"."+s).hasClass(u)){var e=L.clone();t.find("."+n).removeClass(u);e.removeClass(s+" "+o+" "+a);e.prependTo(d).promise().done(function(){_()});t.find("."+n).slice(0,3).addClass(u)}}function _(){setTimeout(function(){g=0;t.find("."+n).each(function(){g+=e(this).outerWidth(true)});d.width(g).promise().done(function(){P();H()})},1)}function D(e){v=t.width();$carouselItemActiveWid=h.width();if(e=="next"){E=h.next()}else if(e=="prev"){E=h.prev()}if(e!=null){$goingToWid=E.width();h.removeClass(s);E.addClass(s);S=$goingToWid/2}b=v/2;y=$carouselItemActiveWid/2}function P(e){if(r.alignment=="left"){w=h.position().left;if(e!=null){$goingToPos=E.position().left}}else if(r.alignment=="right"){w=h.position().left-v+$carouselItemActiveWid;if(e!=null){$goingToPos=E.position().left-v+$goingToWid}}else{w=h.position().left-b+y;if(e!=null){$goingToPos=E.position().left-b+S}}}function H(){A();x=h.data(f);p.removeClass(s);p.each(function(){var t=e(this);if(t.data(f)==x){t.addClass(s);return false}})}function B(){p.click(function(){var t=e(this);A();if(!t.hasClass(s)){var n=t.data(f);var r=e(this).index();if(r>$carouselNavItemActive.index()){E=h.nextUntil("[data-"+f+'="'+n+'"]').addBack().next();E=E.last();$carouselNavItemActive.removeClass(s);E.addClass(s)}else{E=h.prevUntil("[data-"+f+'="'+n+'"]').addBack().prev();E=E.first();var i=E.data(f);$carouselNavItemActive.removeClass(s);E.addClass(s)}p.removeClass(s);t.addClass(s);D("anim");M();O();P("anim");d.css({left:-w}).animate({left:-$goingToPos},C)}})}function j(){_();v=t.width();t.find("."+n).css({"max-width":v});c.find("img").css({"max-width":"100%"});var i=t.find("."+o);if(r.imageCrop==true){var s=1e4;i.each(function(){s=s<e(this).height()?s:e(this).height()})}else{var s=-1;i.each(function(){s=s>e(this).height()?s:e(this).height()})}t.css({height:s});A();D();P();d.css({left:-w})}var t=e(this);var n=r.carouselItemCls;var i=r.carouselNavItemCls;var s=r.activeCls;var o="paw-carousel-item-orig";var u="paw-make-start-clone";var a="paw-make-end-clone";var f="paw-slide-id";var l=r.loadingCls;var c=t.find("."+n);var h=t.find("."+n+"."+s);var p=t.next().find("."+i);var d=t.children("."+r.carouselMediaCls);var v=t.width();var m=c.first().height();var g=0;var y;var b;var w;var E;var S;var x;var T=t.find("."+r.nextLinkCls);var N=t.find("."+r.prevLinkCls);var C=r.animSpeed;var k=r.itemsClonedFromEdge;c.slice(0,k).addClass(u);c.slice(-k).addClass(a);c.addClass(o);var L=t.find("."+o);c.first().addClass(s);c.each(function(t){var n=t+1;e(this).attr("data-"+f,f+"-"+n)});p.each(function(t){var n=t+1;e(this).attr("data-"+f,f+"-"+n)});T.click(function(e){e.preventDefault();A();D("next");O();P("next");d.animate({left:-$goingToPos},C);H()});N.click(function(e){e.preventDefault();A();D("prev");M();P("prev");d.css({left:-w}).animate({left:-$goingToPos},C);H()});e(window).resize(function(){j()});e(window).load(function(){j();A();D();M();B();setTimeout(function(){d.css({top:"0",left:-w})},3);t.find("."+l).fadeOut()})});return this}})(jQuery);
